<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>×—.×¡×‘×Ÿ ×—×•××¨×™ ×‘× ×™×™×Ÿ - ×¦'××˜ ××•× ×¤×©</title>
  <style>
    :root {
      --primary: #25d366;
      --secondary: #075e54;
      --background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
      --shadow: 0 4px 15px rgba(0,0,0,0.2);
      --fallback-bg: #efeae2;
    }
    body {
      font-family: 'Rubik', Arial, sans-serif;
      background: var(--background);
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      direction: rtl;
      overflow: auto;
    }
    .phone-frame {
      width: 380px;
      height: 760px;
      background: url('https://i.postimg.cc/t4Q91FDQ/Screenshot-20250427-160448-Whats-App-Business.jpg') no-repeat center, var(--fallback-bg);
      background-size: cover;
      border-radius: 40px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      transition: all 0.5s ease;
      animation: float 4s ease-in-out infinite;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .phone-frame.fullscreen {
      width: 100%;
      height: 100vh;
      border-radius: 0;
    }
    .chat-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      background: rgba(255,255,255,0.95);
    }
    .chat-header {
      background: var(--secondary);
      color: white;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .chat-header h1 {
      font-size: 20px;
      margin: 0;
    }
    .chat-body {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: var(--fallback-bg);
    }
    .message {
      max-width: 70%;
      margin: 8px;
      padding: 12px;
      border-radius: 15px;
      position: relative;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .user-message {
      background: #d9fdd3;
      margin-left: auto;
    }
    .bot-message {
      background: #ffffff;
      margin-right: auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .welcome-message {
      background: linear-gradient(45deg, #25d366, #128c7e);
      color: white;
      text-align: center;
      margin: 10px auto;
      padding: 15px;
      border-radius: 20px;
      animation: bounceIn 1s ease;
      max-width: 90%;
    }
    @keyframes bounceIn {
      0% { transform: scale(0.1); opacity: 0; }
      60% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); }
    }
    .name-prompt {
      font-weight: bold;
      color: #d81b60;
      border: 2px dashed #d81b60;
      padding: 10px;
      border-radius: 10px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(216,27,96,0.4); }
      70% { box-shadow: 0 0 0 10px rgba(216,27,96,0); }
      100% { box-shadow: 0 0 0 0 rgba(216,27,96,0); }
    }
    .message-time {
      font-size: 10px;
      color: #666;
      position: absolute;
      bottom: 5px;
      left: 10px;
    }
    .chat-footer {
      display: flex;
      align-items: center;
      padding: 10px;
      background: #f0f0f0;
      position: relative;
    }
    #userInput {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 25px;
      margin: 0 10px;
      outline: none;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    #userInput.guide {
      animation: pulse 2s infinite;
    }
    .send-btn, .attach-btn, .fullscreen-btn {
      background: none;
      border: none;
      font-size: 26px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .send-btn:hover, .attach-btn:hover, .fullscreen-btn:hover {
      transform: scale(1.2);
    }
    #keywordsContainer {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 400px;
    }
    .keyword-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      animation: rotate360 12s linear infinite;
      box-shadow: var(--shadow);
    }
    .keyword-btn:hover {
      background: #128c7e;
      transform: scale(1.1);
    }
    @keyframes rotate360 {
      0% { transform: rotate(0deg) translateX(200px) rotate(0deg); }
      100% { transform: rotate(360deg) translateX(200px) rotate(-360deg); }
    }
    @keyframes throwEffect {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(0); opacity: 0; }
    }
    .typing {
      display: flex;
      margin: 10px;
    }
    .typing span {
      width: 12px;
      height: 12px;
      background: #ccc;
      border-radius: 50%;
      margin: 0 4px;
      animation: bounce 0.6s infinite alternate;
    }
    .typing span:nth-child(2) { animation-delay: 0.2s; }
    .typing span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce {
      to { transform: translateY(-6px); }
    }
    #attachMenu {
      display: none;
      position: absolute;
      bottom: 70px;
      right: 10px;
      background: white;
      border-radius: 15px;
      box-shadow: var(--shadow);
      padding: 10px;
    }
    #attachMenu button {
      display: block;
      width: 100%;
      padding: 12px;
      border: none;
      background: none;
      text-align: right;
      cursor: pointer;
      font-size: 16px;
    }
    #attachMenu button:hover {
      background: #f0f0f0;
    }
    #virtualKeyboard {
      display: none;
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #fff;
      padding: 15px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
    }
    .keyboard-row {
      display: flex;
      justify-content: center;
      gap: 5px;
    }
    .key {
      background: #e0e0e0;
      border: none;
      padding: 12px;
      margin: 3px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    .key:hover {
      background: #d0d0d0;
    }
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255,255,255,0.95);
      padding: 25px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      z-index: 1000;
      max-width: 90%;
      max-height: 80%;
      overflow-y: auto;
      animation: fadeIn 0.5s ease;
    }
    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 999;
    }
    .order-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .order-form input, .order-form select {
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }
    .order-form table {
      width: 100%;
      border-collapse: collapse;
    }
    .order-form th, .order-form td {
      padding: 8px;
      border: 1px solid #ccc;
      text-align: right;
    }
    .order-form .remove-item {
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      padding: 8px;
    }
    .order-form .add-item {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
    }
    .popup button:not(.add-item):not(.remove-item) {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 12px;
    }
    #stylus {
      position: absolute;
      width: 24px;
      height: 24px;
      top: 10px;
      right: 10px;
      transition: transform 0.3s ease;
    }
    #stylus.typing {
      transform: rotate(-45deg) translate(-5px, 5px);
    }
    @media (max-width: 600px) {
      .phone-frame {
        width: 100%;
        height: 100vh;
        border-radius: 0;
      }
      .keyword-btn {
        padding: 10px 18px;
        font-size: 14px;
      }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="phoneFrame" class="phone-frame">
    <div class="chat-container">
      <div class="chat-header">
        <h1>×—.×¡×‘×Ÿ ×—×•××¨×™ ×‘× ×™×™×Ÿ ğŸ—ï¸</h1>
        <button class="fullscreen-btn" onclick="toggleFullscreen()">ğŸ”²</button>
      </div>
      <div id="chatBody" class="chat-body"></div>
      <div class="chat-footer">
        <button class="attach-btn" onclick="toggleAttachMenu()">ğŸ“</button>
        <input id="userInput" type="text" placeholder="×”×§×œ×“ ×”×•×“×¢×”..." oninput="moveStylus()" onfocus="showKeyboard()">
        <button class="send-btn" onclick="sendMessage()">â¤</button>
        <img id="stylus" src="https://i.postimg.cc/3J9Y4b0Z/blocks.jpg" alt="Stylus">
      </div>
      <div id="attachMenu">
        <button onclick="document.getElementById('fileInput').click()">ğŸ“„ ×”×¢×œ×” ×§×•×‘×¥</button>
        <button onclick="shareLocation()">ğŸ“ ×©×ª×£ ××™×§×•×</button>
        <button onclick="addToCalendar()">ğŸ“… ×”×•×¡×£ ×œ×œ×•×— ×©× ×”</button>
        <button onclick="openOrderPopup()">ğŸ“‹ ×˜×•×¤×¡ ×”×–×× ×”</button>
        <button onclick="openHowToPopup()">â“ ××™×š ×× ×™ ×¢×•×‘×“?</button>
      </div>
      <input type="file" id="fileInput" style="display: none;" onchange="uploadFile()">
    </div>
    <div id="keywordsContainer"></div>
  </div>

  <div id="virtualKeyboard">
    <div class="keyboard-row">
      <button class="key" onclick="typeKey('×')">×</button>
      <button class="key" onclick="typeKey('×‘')">×‘</button>
      <button class="key" onclick="typeKey('×’')">×’</button>
      <button class="key" onclick="typeKey('×“')">×“</button>
      <button class="key" onclick="typeKey('×”')">×”</button>
      <button class="key" onclick="typeKey('×•')">×•</button>
      <button class="key" onclick="typeKey('×–')">×–</button>
      <button class="key" onclick="typeKey('×—')">×—</button>
      <button class="key" onclick="typeKey('×˜')">×˜</button>
    </div>
    <div class="keyboard-row">
      <button class="key" onclick="typeKey('×™')">×™</button>
      <button class="key" onclick="typeKey('×›')">×›</button>
      <button class="key" onclick="typeKey('×œ')">×œ</button>
      <button class="key" onclick="typeKey('×')">×</button>
      <button class="key" onclick="typeKey('× ')">× </button>
      <button class="key" onclick="typeKey('×¡')">×¡</button>
      <button class="key" onclick="typeKey('×¢')">×¢</button>
      <button class="key" onclick="typeKey('×¤')">×¤</button>
      <button class="key" onclick="typeKey('×¦')">×¦</button>
    </div>
    <div class="keyboard-row">
      <button class="key" onclick="typeKey('×§')">×§</button>
      <button class="key" onclick="typeKey('×¨')">×¨</button>
      <button class="key" onclick="typeKey('×©')">×©</button>
      <button class="key" onclick="typeKey('×ª')">×ª</button>
      <button class="key" onclick="typeKey(' ')">×¨×•×•×—</button>
      <button class="key" onclick="closeKeyboard()">×¡×’×•×¨</button>
    </div>
  </div>

  <div id="orderPopup" class="popup">
    <h2>×˜×•×¤×¡ ×”×–×× ×” ğŸ“‹</h2>
    <div class="order-form">
      <input id="orderCustomer" type="text" placeholder="×©× ×”×œ×§×•×—">
      <input id="orderContact" type="text" placeholder="××™×© ×§×©×¨">
      <input id="orderPhone" type="tel" placeholder="××¡×¤×¨ × ×™×™×“">
      <select id="orderCrane">
        <option value="">×‘×—×¨ ×¡×•×’ ×× ×•×£</option>
        <option value="×× ×•×£ 20 ×˜×•×Ÿ">×× ×•×£ 20 ×˜×•×Ÿ</option>
        <option value="×× ×•×£ 50 ×˜×•×Ÿ">×× ×•×£ 50 ×˜×•×Ÿ</option>
        <option value="×œ×œ×">×œ×œ×</option>
      </select>
      <input id="orderStreet" type="text" placeholder="×¨×—×•×‘">
      <input id="orderCity" type="text" placeholder="×¢×™×¨">
      <select id="orderContainer" onchange="showContainerCost()">
        <option value="×œ×œ×">×œ×œ× ×¤×¢×•×œ×ª ××›×•×œ×”</option>
        <option value="××›×•×œ×” 20 ×¨×’×œ">××›×•×œ×” 20 ×¨×’×œ</option>
        <option value="××›×•×œ×” 40 ×¨×’×œ">××›×•×œ×” 40 ×¨×’×œ</option>
      </select>
      <p id="containerCost" style="display: none; color: #d81b60;">×¢×œ×•×ª ×¤×¢×•×œ×ª ××›×•×œ×”: 500 ×©"×—</p>
      <table>
        <thead>
          <tr>
            <th>×©× ×”××•×¦×¨</th>
            <th>×›××•×ª</th>
            <th>××—×™×¨ ×œ×™×—×™×“×”</th>
            <th>×”×¡×¨</th>
          </tr>
        </thead>
        <tbody id="itemsTableBody">
          <tr class="item-row">
            <td><select class="item-name" onchange="updateItemPrice(this)"></select></td>
            <td><input type="number" class="item-quantity" min="1" placeholder="×›××•×ª"></td>
            <td><input type="text" class="item-price" readonly></td>
            <td><button class="remove-item" onclick="removeItemRow(this)">Ã—</button></td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="add-item" onclick="addItemRow()">×”×•×¡×£ ×¤×¨×™×˜</button>
      <button type="button" onclick="submitOrder()">×©×œ×— ×”×–×× ×” ğŸš›</button>
      <button type="button" onclick="closeOrderPopup()">×‘×˜×œ</button>
    </div>
  </div>

  <div id="howToPopup" class="popup">
    <h2>××™×š ×× ×™ ×¢×•×‘×“? â“</h2>
    <p>×‘×¨×•×›×™× ×”×‘××™× ×œ×¦'××˜ ×©×œ ×—.×¡×‘×Ÿ ×—×•××¨×™ ×‘× ×™×™×Ÿ! ğŸ—ï¸ ×× ×™ ×¨×××™, ×”×‘×•×˜ ×©×™×¢×–×•×¨ ×œ×›× ×¢× ×”×›×œ!</p>
    <ul>
      <li>×”×§×œ×™×“×• ××ª ×©××›× ×›×“×™ ×œ×”×ª×—×™×œ.</li>
      <li>×©××œ×• ×¢×œ ××•×¦×¨×™× ×›××• "×‘×œ×•×§×™×" ××• "×¦×‘×¢×™×".</li>
      <li>×œ×—×¦×• ×¢×œ ×›×¤×ª×•×¨×™ ××™×œ×•×ª ×”××¤×ª×— ×œ×¡×™×•×¢ ××”×™×¨.</li>
      <li>×”×©×ª××©×• ×‘×˜×•×¤×¡ ×”×”×–×× ×” ×œ×¨×›×™×©×ª ××•×¦×¨×™×.</li>
      <li>×©×ª×¤×• ××™×§×•× ××• ×”×¢×œ×• ×§×‘×¦×™× ×“×¨×š ×ª×¤×¨×™×˜ ×”×§×‘×¦×™×.</li>
      <li>×¨×•×¦×™× ×œ×“×¢×ª ××” ×”×©× ×©×œ×›× ××•××¨? ×©××œ×• ××•×ª×™! ğŸ˜</li>
    </ul>
    <button onclick="closeHowToPopup()">×¡×’×•×¨</button>
  </div>

  <div id="overlay"></div>

  <script src="app.js"></script>
</body>
</html>